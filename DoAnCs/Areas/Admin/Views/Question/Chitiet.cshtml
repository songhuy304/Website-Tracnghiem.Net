@model List<DoAnCs.Models.Viewmodel.SubjectItem>
@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_layout.cshtml";
}

<div class="order">
    <input id="idquestion" type="hidden" name="name" value="@ViewBag.Id" />
    <button style="margin-bottom:30px" id="buttonThem" class="btn btn-primary">Thêm Đáp Án</button>
    @Html.Partial("~/Areas/Admin/Views/Question/themdapan.cshtml")

    @if (Model.Any() && Model != null)
    {
        var i = 1;

        <table>
            <thead>
                <tr class="text-center">
                    <th><input class="checkbox1" type="checkbox"> </th>
                    <th>STT</th>
                    <th>Tên Câu Hỏi</th>
                    <th>Đáp Án Đúng</th>

                    <th class="float-right"></th>
                </tr>
            </thead>
            <tbody>

                @foreach (var item in Model)
                {
                    var truis = item.Trueis ? 1 : 0;
                    <tr id="row_@item.id">
                        <td>
                            <div class="form-check">
                                <input class="form-check-input custom-checkbox" type="checkbox" name="group1">
                            </div>
                        </td>
                        <td>
                            <p>@i</p>
                        </td>
                        <td> @Html.Raw(HttpUtility.HtmlDecode(item.Content))</td>
                        <td>
                            <div class="form-check">
                                <input class="form-check-input custom-checkbox" type="checkbox" name="group1" disabled @(truis == 1 ? "checked" : "")>
                            </div>
                        </td>

                        <td class="float-right">
                            <button class="btn btn-danger delete-item" data-id-index="@item.id"><i class="fa fa-trash" style="color: white;"></i></button>
                        </td>
                    </tr>

                    i++;
                }


            </tbody>
        </table>


    }
    else
    {
        <p>Không Có Gì</p>
    }
</div>

@section scripts{
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        $(document).ready(function () {
            CKEDITOR.replace('inputContentt2', {
                removeButtons: 'Link,Unlink,Anchor,Form,Checkbox,Textarea,Button,ImageButton,HiddenField,TextField,SelectAll,Replace,Find,Redo,Undo,Paste,Copy,Cut,Templates,Print,Preview,Save,NewPage,Smiley,Flash,Maximize,ShowBlocks,Scayt,Indent,Outdent,Blockquote,CreateDiv,BidiLtr,BidiRtl,Language,PageBreak,Iframe,SpecialChar,Smiley,HorizontalRule,Radio,Select,PasteText,PasteFromWord,Source,Bold,Italic,Underline,Strike,Superscript,Subscript,CopyFormatting,RemoveFormat,NumberedList,BulletedList,JustifyLeft,JustifyCenter,JustifyRight,JustifyBlock,Table,Styles,Format,Font,FontSize,TextColor,BGColor,About'

            });
            function BrowseServer() {
                var finder = new CKFinder();
                finder.selectActionFunction = URlHinhAnh;
                finder.popup();
            }
            function URlHinhAnh(url) {
                $("input[name=HinhAnh]").val(url);
            }
            var idquestion = document.getElementById("idquestion").value;


            //show modal
            $('#buttonThem').click(function () {
                $('#exampleModal').modal('show');
            });
            //sự kiện thêm record
            $("#themdapan").on("click", function () {

                var content = CKEDITOR.instances.inputContentt2.getData();
                var trueis = $('#checkbox').prop('checked');
                var data = {
                    newsub: {
                        Content: content,
                        Trueis: trueis
                    },
                    questionId: idquestion
                }
                $.ajax({
                    url: "/admin/question/themdapan",
                    type: "POST",
                    data: data,
                    success: function (result) {
                            toastr.success('Thêm Thành Công');
                      
                       
                    
                    },
                    error: function (error) {

                        console.log(error);
                    }
                });


            });
            // Xử lý sự kiện click nút "Xóa"
            $(".delete-item").on("click", function () {
                var itemIndex = $(this).data("id-index");
                if (confirm('Bạn Muốn Xóa Record này không nhỉ?')) {
                    $.ajax({
                        url: "/admin/question/DeleteRecord",
                        type: "POST",
                        data: { questionId: idquestion, recordId: itemIndex },
                        success: function (result) {
                            if (result.success) {
                                var rowId = "#row_" + itemIndex;
                                $(rowId).remove();
                                toastr.success('Xóa Thành Công');
                            } else {
                                toastr.error('Xóa Thất Bại');

                            }
                        },
                        error: function (error) {

                            console.log(error);
                        }
                    });
                }

            });
        });
    </script>
}

